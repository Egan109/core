<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_40) on Fri Sep 04 18:09:10 PDT 2015 -->
<title>org.transitime.ipc.rmi</title>
<meta name="date" content="2015-09-04">
<link rel="stylesheet" type="text/css" href="../../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="org.transitime.ipc.rmi";
        }
    }
    catch(err) {
    }
//-->
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/transitime/ipc/jms/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../org/transitime/ipc/servers/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/transitime/ipc/rmi/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<div class="header">
<h1 title="Package" class="title">Package&nbsp;org.transitime.ipc.rmi</h1>
<div class="docSummary">
<div class="block">The org.transitime.ipc.rmi package is for making it easy to have remote RMI 
 access to objects on the server.</div>
</div>
<p>See:&nbsp;<a href="#package.description">Description</a></p>
</div>
<div class="contentContainer">
<ul class="blockList">
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Interface Summary table, listing interfaces, and an explanation">
<caption><span>Interface Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Interface</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/Hello.html" title="interface in org.transitime.ipc.rmi">Hello</a></td>
<td class="colLast">
<div class="block">A test interface for showing how can work with RMI</div>
</td>
</tr>
</tbody>
</table>
</li>
<li class="blockList">
<table class="typeSummary" border="0" cellpadding="3" cellspacing="0" summary="Class Summary table, listing classes, and an explanation">
<caption><span>Class Summary</span><span class="tabEnd">&nbsp;</span></caption>
<tr>
<th class="colFirst" scope="col">Class</th>
<th class="colLast" scope="col">Description</th>
</tr>
<tbody>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/AbstractServer.html" title="class in org.transitime.ipc.rmi">AbstractServer</a></td>
<td class="colLast">
<div class="block">This class does all of the work on the server side for an RMI object.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/ClientFactory.html" title="class in org.transitime.ipc.rmi">ClientFactory</a>&lt;T extends java.rmi.Remote&gt;</td>
<td class="colLast">
<div class="block">For clients to access RMI based method calls for a remote object simply need
 to call something like: Hello hello = ClientFactory.getInstance(agencyId,
 Hello.class);</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/HelloClient.html" title="class in org.transitime.ipc.rmi">HelloClient</a></td>
<td class="colLast">
<div class="block">Sample test program to show how a client can do RMI calls.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/HelloServer.html" title="class in org.transitime.ipc.rmi">HelloServer</a></td>
<td class="colLast">
<div class="block">A sample RMI server class.</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/RmiCallInvocationHandler.html" title="class in org.transitime.ipc.rmi">RmiCallInvocationHandler</a></td>
<td class="colLast">
<div class="block">This code is called on the client side when RMI object is accessed.</div>
</td>
</tr>
<tr class="rowColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/RmiParams.html" title="class in org.transitime.ipc.rmi">RmiParams</a></td>
<td class="colLast">
<div class="block">For defining port numbers to be used for RMI</div>
</td>
</tr>
<tr class="altColor">
<td class="colFirst"><a href="../../../../org/transitime/ipc/rmi/RmiStubInfo.html" title="class in org.transitime.ipc.rmi">RmiStubInfo</a></td>
<td class="colLast">
<div class="block">Contains the info needed for creating an RMI stub, including the agency ID
 and the agency host name.</div>
</td>
</tr>
</tbody>
</table>
</li>
</ul>
<a name="package.description">
<!--   -->
</a>
<h2 title="Package org.transitime.ipc.rmi Description">Package org.transitime.ipc.rmi Description</h2>
<div class="block">The org.transitime.ipc.rmi package is for making it easy to have remote RMI 
 access to objects on the server. In particular, it is intended for "command"
 type of objects that do not change. They are simply used for changing
 state of a server or reading information from it.
 <p>
 The RMI registry needs to be run for this to work. Because don't want to 
 interfere with other possible uses of the RMI registry a special port 2099 is 
 used instead of the default 1099. Since it can be a nuisance to make sure that
 the rmiregistry is running the registry will be started automatically if it  
 isn't currently running. If you want to run it manually, the registry comes
 with the JDK, which means the executable can be found in a place such as
 C:/Program Files/Java/jdk1.7.0_25/bin/rmiregistry.exe . With changes to the
 RMI system with version 1.7_20 of Java you need to specify the codebase
 if you run the rmiregistry manually. It would be started using something like:
 <code>/usr/lib/jvm/jre/bin/rmiregistry -J-Djava.rmi.server.codebase=file:/home/ec2-user/jars/transitime.jar 2099 &</code>
 <p>
 AbstractServer configures RMI to not use port 0, basically a random port, when
 establishing communication (the main port 2099 is used to establish communication
 but then communication is handed off to a separate port). Instead of using 
 port 0 for actually sending commands to a server, RMI is configured to use a 
 special port via the Java property -Dtransitime.rmi.secondaryRmiPort. 
 The default value is 2098. In this 
 way the firewalls for the servers can be configured to be open just for the 
 ports that are actually used, which is much safer than having to completely 
 open up network traffic. Every server on a machine must use a different 
 secondary port for communication. This means that if you have multiple core 
 systems running on a server only one can use the default secondary RMI port.
 The other core systems will need to have a different port specified by
 -Dtransitime.rmi.secondaryRmiPort .
 <p>
 An important issue is that when running on AWS the RMI server needs to be run 
 using Java property -Djava.rmi.server.hostname=PUBLIC_DOMAIN.amazonaws.com .
 Otherwise RMI server will tell the client to use an internal IP address,
 resulting in the client simply timing out. This was a particularly difficult
 issue to resolve. The key documentation on this issue was found in the
 "Java Remote Method Invocation" document in the section 
 3.5 RMI Through Firewalls Via Proxies. 
 <p>
 The purpose of these classes is to make the system robust and easy to use.
 The server not only initializes the object but also will reconnect if the
 registry restarts for some reason. On the client side the objects are
 initialized and when a remote call is made an InvocationHandler is used
 to both instrument the call but also to handle exceptions and retry
 communication as appropriate. If an RMI stub needs to be recreated
 due to server restart etc it is automatically redone. This means that
 the connection to the server is robust and easy to use.
 <p>
 Proxy objects are used so that each RMI call is instrumented. Since each
 RMI object is a proxy RmiCallInvocationHandler.invoke() is called for
 each RMI call. In invoke() the calls are logged and timed. Also, 
 the number of current calls to a project are limited so that the
 server cannot be overwhelmed. This prevents problems due to denial of
 service attack or the project doing stop the world garbage collecting
 and therefore being unavailable for a while.
 <p>
 To create a RMI object do the following:
 <ul>
 <li> Create an interface class that inherits from java.rmi.Remote class. The
 interface class defines the methods that are used to read or write info to
 a server. Each method that should be accessible remotely should throw 
 java.rmi.RemoteException.</li>
 <li> Create a server class that extends AbstractServer and implements the interface class.</li>
 <li> The server class needs a constructor that calls super(projectId, objectName)</li>
 <li> The server class should implement the remote methods defined in the interface.</li>
 <li> For the client create an object such as (for the "Hello" interface class in
 this example) Hello hello = ClientFactory.getInstance(projectId, Hello.class);</li>
 </ul>
 <p>
 Exceptions:
 <ul>
 <li>If get a ConnectException then likely the RMI registry is not running.</li>
 <li>If get NotBoundException then the server object hasn't been created</li>
 </ul></div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>SkiBu Smith</dd>
</dl>
</div>
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../../overview-summary.html">Overview</a></li>
<li class="navBarCell1Rev">Package</li>
<li>Class</li>
<li><a href="package-use.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../../org/transitime/ipc/jms/package-summary.html">Prev&nbsp;Package</a></li>
<li><a href="../../../../org/transitime/ipc/servers/package-summary.html">Next&nbsp;Package</a></li>
</ul>
<ul class="navList">
<li><a href="../../../../index.html?org/transitime/ipc/rmi/package-summary.html" target="_top">Frames</a></li>
<li><a href="package-summary.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
