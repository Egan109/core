<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.01 Transitional//EN" "http://www.w3.org/TR/html4/loose.dtd">
<!-- NewPage -->
<html lang="en">
<head>
<!-- Generated by javadoc (1.8.0_40) on Fri Sep 04 18:09:09 PDT 2015 -->
<title>AvlProcessor</title>
<meta name="date" content="2015-09-04">
<link rel="stylesheet" type="text/css" href="../../../stylesheet.css" title="Style">
<script type="text/javascript" src="../../../script.js"></script>
</head>
<body>
<script type="text/javascript"><!--
    try {
        if (location.href.indexOf('is-external=true') == -1) {
            parent.document.title="AvlProcessor";
        }
    }
    catch(err) {
    }
//-->
var methods = {"i0":10,"i1":9,"i2":10,"i3":10,"i4":10,"i5":10,"i6":10,"i7":10,"i8":10,"i9":10};
var tabs = {65535:["t0","All Methods"],1:["t1","Static Methods"],2:["t2","Instance Methods"],8:["t4","Concrete Methods"]};
var altColor = "altColor";
var rowColor = "rowColor";
var tableTab = "tableTab";
var activeTableTab = "activeTableTab";
</script>
<noscript>
<div>JavaScript is disabled on your browser.</div>
</noscript>
<!-- ========= START OF TOP NAVBAR ======= -->
<div class="topNav"><a name="navbar.top">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.top" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.top.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AvlProcessor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/transitime/core/ArrivalDepartureGeneratorFactory.html" title="class in org.transitime.core"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../org/transitime/core/BlockAssigner.html" title="class in org.transitime.core"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/transitime/core/AvlProcessor.html" target="_top">Frames</a></li>
<li><a href="AvlProcessor.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_top">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_top");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.top">
<!--   -->
</a></div>
<!-- ========= END OF TOP NAVBAR ========= -->
<!-- ======== START OF CLASS DATA ======== -->
<div class="header">
<div class="subTitle">org.transitime.core</div>
<h2 title="Class AvlProcessor" class="title">Class AvlProcessor</h2>
</div>
<div class="contentContainer">
<ul class="inheritance">
<li>java.lang.Object</li>
<li>
<ul class="inheritance">
<li>org.transitime.core.AvlProcessor</li>
</ul>
</li>
</ul>
<div class="description">
<ul class="blockList">
<li class="blockList">
<hr>
<br>
<pre>public class <span class="typeNameLabel">AvlProcessor</span>
extends java.lang.Object</pre>
<div class="block">This is a very important high-level class. It takes the AVL data and
 processes it. Matches vehicles to their assignments. Once a match is made
 then MatchProcessor class is used to generate predictions, arrival/departure
 times, headway, etc.</div>
<dl>
<dt><span class="simpleTagLabel">Author:</span></dt>
<dd>SkiBu Smith</dd>
</dl>
</li>
</ul>
</div>
<div class="summary">
<ul class="blockList">
<li class="blockList">
<!-- ========== METHOD SUMMARY =========== -->
<ul class="blockList">
<li class="blockList"><a name="method.summary">
<!--   -->
</a>
<h3>Method Summary</h3>
<table class="memberSummary" border="0" cellpadding="3" cellspacing="0" summary="Method Summary table, listing methods, and an explanation">
<caption><span id="t0" class="activeTableTab"><span>All Methods</span><span class="tabEnd">&nbsp;</span></span><span id="t1" class="tableTab"><span><a href="javascript:show(1);">Static Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t2" class="tableTab"><span><a href="javascript:show(2);">Instance Methods</a></span><span class="tabEnd">&nbsp;</span></span><span id="t4" class="tableTab"><span><a href="javascript:show(8);">Concrete Methods</a></span><span class="tabEnd">&nbsp;</span></span></caption>
<tr>
<th class="colFirst" scope="col">Modifier and Type</th>
<th class="colLast" scope="col">Method and Description</th>
</tr>
<tr id="i0" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#cacheAvlReportWithoutProcessing-org.transitime.db.structs.AvlReport-">cacheAvlReportWithoutProcessing</a></span>(<a href="../../../org/transitime/db/structs/AvlReport.html" title="class in org.transitime.db.structs">AvlReport</a>&nbsp;avlReport)</code>
<div class="block">Updates the VehicleState in the cache to have the new avlReport.</div>
</td>
</tr>
<tr id="i1" class="rowColor">
<td class="colFirst"><code>static <a href="../../../org/transitime/core/AvlProcessor.html" title="class in org.transitime.core">AvlProcessor</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#getInstance--">getInstance</a></span>()</code>
<div class="block">Returns the singleton AvlProcessor</div>
</td>
</tr>
<tr id="i2" class="altColor">
<td class="colFirst"><code><a href="../../../org/transitime/db/structs/AvlReport.html" title="class in org.transitime.db.structs">AvlReport</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#getLastAvlReport--">getLastAvlReport</a></span>()</code>
<div class="block">Returns the last regular (non-schedule based) AvlReport.</div>
</td>
</tr>
<tr id="i3" class="rowColor">
<td class="colFirst"><code>long</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#lastAvlReportTime--">lastAvlReportTime</a></span>()</code>
<div class="block">Returns the GPS time of the last regular (non-schedule based) GPS report
 processed.</div>
</td>
</tr>
<tr id="i4" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#makeVehicleUnpredictable-java.lang.String-java.lang.String-java.lang.String-">makeVehicleUnpredictable</a></span>(java.lang.String&nbsp;vehicleId,
                        java.lang.String&nbsp;eventDescription,
                        java.lang.String&nbsp;vehicleEvent)</code>
<div class="block">Removes predictions and the match for the vehicle and marks it as
 unpredictable.</div>
</td>
</tr>
<tr id="i5" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#makeVehicleUnpredictableAndGrabAssignment-org.transitime.core.VehicleState-java.lang.String-java.lang.String-">makeVehicleUnpredictableAndGrabAssignment</a></span>(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState,
                                         java.lang.String&nbsp;eventDescription,
                                         java.lang.String&nbsp;vehicleEvent)</code>
<div class="block">Marks the vehicle as not being predictable and that the assignment has
 been grabbed.</div>
</td>
</tr>
<tr id="i6" class="altColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#makeVehicleUnpredictableAndTerminateAssignment-org.transitime.core.VehicleState-java.lang.String-java.lang.String-">makeVehicleUnpredictableAndTerminateAssignment</a></span>(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState,
                                              java.lang.String&nbsp;eventDescription,
                                              java.lang.String&nbsp;vehicleEvent)</code>
<div class="block">Removes predictions and the match for the vehicle and marks is as
 unpredictable.</div>
</td>
</tr>
<tr id="i7" class="rowColor">
<td class="colFirst"><code><a href="../../../org/transitime/core/TemporalMatch.html" title="class in org.transitime.core">TemporalMatch</a></code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#matchNewFixForPredictableVehicle-org.transitime.core.VehicleState-">matchNewFixForPredictableVehicle</a></span>(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState)</code>
<div class="block">For vehicles that were already predictable but then got a new AvlReport.</div>
</td>
</tr>
<tr id="i8" class="altColor">
<td class="colFirst"><code>boolean</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#matchVehicleToAssignment-org.transitime.core.VehicleState-">matchVehicleToAssignment</a></span>(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState)</code>
<div class="block">To be called when vehicle doesn't already have a block assignment or the
 vehicle is being reassigned.</div>
</td>
</tr>
<tr id="i9" class="rowColor">
<td class="colFirst"><code>void</code></td>
<td class="colLast"><code><span class="memberNameLink"><a href="../../../org/transitime/core/AvlProcessor.html#processAvlReport-org.transitime.db.structs.AvlReport-">processAvlReport</a></span>(<a href="../../../org/transitime/db/structs/AvlReport.html" title="class in org.transitime.db.structs">AvlReport</a>&nbsp;avlReport)</code>
<div class="block">First does housekeeping for the AvlReport (stores it in db, logs it,
 etc).</div>
</td>
</tr>
</table>
<ul class="blockList">
<li class="blockList"><a name="methods.inherited.from.class.java.lang.Object">
<!--   -->
</a>
<h3>Methods inherited from class&nbsp;java.lang.Object</h3>
<code>equals, getClass, hashCode, notify, notifyAll, toString, wait, wait, wait</code></li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
<div class="details">
<ul class="blockList">
<li class="blockList">
<!-- ============ METHOD DETAIL ========== -->
<ul class="blockList">
<li class="blockList"><a name="method.detail">
<!--   -->
</a>
<h3>Method Detail</h3>
<a name="getInstance--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getInstance</h4>
<pre>public static&nbsp;<a href="../../../org/transitime/core/AvlProcessor.html" title="class in org.transitime.core">AvlProcessor</a>&nbsp;getInstance()</pre>
<div class="block">Returns the singleton AvlProcessor</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a name="makeVehicleUnpredictable-java.lang.String-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeVehicleUnpredictable</h4>
<pre>public&nbsp;void&nbsp;makeVehicleUnpredictable(java.lang.String&nbsp;vehicleId,
                                     java.lang.String&nbsp;eventDescription,
                                     java.lang.String&nbsp;vehicleEvent)</pre>
<div class="block">Removes predictions and the match for the vehicle and marks it as
 unpredictable. Updates VehicleDataCache. Creates and logs a VehicleEvent
 explaining the situation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>vehicleId</code> - The vehicle to be made unpredictable</dd>
<dd><code>eventDescription</code> - A longer description of why vehicle being made unpredictable</dd>
<dd><code>vehicleEvent</code> - A short description from VehicleEvent class for labeling the
            event.</dd>
</dl>
</li>
</ul>
<a name="makeVehicleUnpredictableAndTerminateAssignment-org.transitime.core.VehicleState-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeVehicleUnpredictableAndTerminateAssignment</h4>
<pre>public&nbsp;void&nbsp;makeVehicleUnpredictableAndTerminateAssignment(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState,
                                                           java.lang.String&nbsp;eventDescription,
                                                           java.lang.String&nbsp;vehicleEvent)</pre>
<div class="block">Removes predictions and the match for the vehicle and marks is as
 unpredictable. Also removes block assignment from the vehicleState. To be
 used for situations such as assignment ended or vehicle was reassigned.
 Creates and logs a VehicleEvent explaining the situation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>vehicleState</code> - The vehicle to be made unpredictable</dd>
<dd><code>eventDescription</code> - A longer description of why vehicle being made unpredictable</dd>
<dd><code>vehicleEvent</code> - A short description from VehicleEvent class for labeling the
            event.</dd>
</dl>
</li>
</ul>
<a name="makeVehicleUnpredictableAndGrabAssignment-org.transitime.core.VehicleState-java.lang.String-java.lang.String-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>makeVehicleUnpredictableAndGrabAssignment</h4>
<pre>public&nbsp;void&nbsp;makeVehicleUnpredictableAndGrabAssignment(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState,
                                                      java.lang.String&nbsp;eventDescription,
                                                      java.lang.String&nbsp;vehicleEvent)</pre>
<div class="block">Marks the vehicle as not being predictable and that the assignment has
 been grabbed. Updates VehicleDataCache. Creates and logs a VehicleEvent
 explaining the situation.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>vehicleState</code> - The vehicle to be made unpredictable</dd>
<dd><code>eventDescription</code> - A longer description of why vehicle being made unpredictable</dd>
<dd><code>vehicleEvent</code> - A short description from VehicleEvent class for labeling the
            event.</dd>
</dl>
</li>
</ul>
<a name="matchNewFixForPredictableVehicle-org.transitime.core.VehicleState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>matchNewFixForPredictableVehicle</h4>
<pre>public&nbsp;<a href="../../../org/transitime/core/TemporalMatch.html" title="class in org.transitime.core">TemporalMatch</a>&nbsp;matchNewFixForPredictableVehicle(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState)</pre>
<div class="block">For vehicles that were already predictable but then got a new AvlReport.
 Determines where in the block assignment the vehicle now matches to.
 Starts at the previous match and then looks ahead from there to find good
 spatial matches. Then determines which spatial match is best by looking
 at temporal match. Updates the vehicleState with the resulting best
 temporal match.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>vehicleState</code> - the previous vehicle state</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>the new match, if successful. Otherwise null.</dd>
</dl>
</li>
</ul>
<a name="matchVehicleToAssignment-org.transitime.core.VehicleState-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>matchVehicleToAssignment</h4>
<pre>public&nbsp;boolean&nbsp;matchVehicleToAssignment(<a href="../../../org/transitime/core/VehicleState.html" title="class in org.transitime.core">VehicleState</a>&nbsp;vehicleState)</pre>
<div class="block">To be called when vehicle doesn't already have a block assignment or the
 vehicle is being reassigned. Uses block assignment from the AvlReport to
 try to match the vehicle to the assignment. If successful then the
 vehicle can be made predictable. The AvlReport is obtained from the
 vehicleState parameter.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>avlReport</code> - </dd>
<dd><code>vehicleState</code> - provides current AvlReport plus is updated by this method with
            the new state.</dd>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>true if successfully assigned vehicle</dd>
</dl>
</li>
</ul>
<a name="lastAvlReportTime--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>lastAvlReportTime</h4>
<pre>public&nbsp;long&nbsp;lastAvlReportTime()</pre>
<div class="block">Returns the GPS time of the last regular (non-schedule based) GPS report
 processed. Since AvlClient filters out reports that are for a previous
 time for a vehicle even if the AVL feed continues to feed old data that
 data will be ignored. In other words, the last AVL time will be for that
 last valid AVL report.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
<dd>The GPS time of last AVL report, or 0 if no last AVL report</dd>
</dl>
</li>
</ul>
<a name="getLastAvlReport--">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>getLastAvlReport</h4>
<pre>public&nbsp;<a href="../../../org/transitime/db/structs/AvlReport.html" title="class in org.transitime.db.structs">AvlReport</a>&nbsp;getLastAvlReport()</pre>
<div class="block">Returns the last regular (non-schedule based) AvlReport.</div>
<dl>
<dt><span class="returnLabel">Returns:</span></dt>
</dl>
</li>
</ul>
<a name="cacheAvlReportWithoutProcessing-org.transitime.db.structs.AvlReport-">
<!--   -->
</a>
<ul class="blockList">
<li class="blockList">
<h4>cacheAvlReportWithoutProcessing</h4>
<pre>public&nbsp;void&nbsp;cacheAvlReportWithoutProcessing(<a href="../../../org/transitime/db/structs/AvlReport.html" title="class in org.transitime.db.structs">AvlReport</a>&nbsp;avlReport)</pre>
<div class="block">Updates the VehicleState in the cache to have the new avlReport. Intended
 for when want to update VehicleState AVL report but don't want to
 actually process the report, such as for when get data too frequently and
 only want to fully process some of it yet still use latest vehicle
 location so that vehicles move on map really smoothly.</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>avlReport</code> - </dd>
</dl>
</li>
</ul>
<a name="processAvlReport-org.transitime.db.structs.AvlReport-">
<!--   -->
</a>
<ul class="blockListLast">
<li class="blockList">
<h4>processAvlReport</h4>
<pre>public&nbsp;void&nbsp;processAvlReport(<a href="../../../org/transitime/db/structs/AvlReport.html" title="class in org.transitime.db.structs">AvlReport</a>&nbsp;avlReport)</pre>
<div class="block">First does housekeeping for the AvlReport (stores it in db, logs it,
 etc). Processes the AVL report by matching to the assignment and
 generating predictions and such. Sets VehicleState for the vehicle based
 on the results. Also stores AVL report into the database (if not in
 playback mode).</div>
<dl>
<dt><span class="paramLabel">Parameters:</span></dt>
<dd><code>avlReport</code> - The new AVL report to be processed</dd>
</dl>
</li>
</ul>
</li>
</ul>
</li>
</ul>
</div>
</div>
<!-- ========= END OF CLASS DATA ========= -->
<!-- ======= START OF BOTTOM NAVBAR ====== -->
<div class="bottomNav"><a name="navbar.bottom">
<!--   -->
</a>
<div class="skipNav"><a href="#skip.navbar.bottom" title="Skip navigation links">Skip navigation links</a></div>
<a name="navbar.bottom.firstrow">
<!--   -->
</a>
<ul class="navList" title="Navigation">
<li><a href="../../../overview-summary.html">Overview</a></li>
<li><a href="package-summary.html">Package</a></li>
<li class="navBarCell1Rev">Class</li>
<li><a href="class-use/AvlProcessor.html">Use</a></li>
<li><a href="package-tree.html">Tree</a></li>
<li><a href="../../../deprecated-list.html">Deprecated</a></li>
<li><a href="../../../index-files/index-1.html">Index</a></li>
<li><a href="../../../help-doc.html">Help</a></li>
</ul>
</div>
<div class="subNav">
<ul class="navList">
<li><a href="../../../org/transitime/core/ArrivalDepartureGeneratorFactory.html" title="class in org.transitime.core"><span class="typeNameLink">Prev&nbsp;Class</span></a></li>
<li><a href="../../../org/transitime/core/BlockAssigner.html" title="class in org.transitime.core"><span class="typeNameLink">Next&nbsp;Class</span></a></li>
</ul>
<ul class="navList">
<li><a href="../../../index.html?org/transitime/core/AvlProcessor.html" target="_top">Frames</a></li>
<li><a href="AvlProcessor.html" target="_top">No&nbsp;Frames</a></li>
</ul>
<ul class="navList" id="allclasses_navbar_bottom">
<li><a href="../../../allclasses-noframe.html">All&nbsp;Classes</a></li>
</ul>
<div>
<script type="text/javascript"><!--
  allClassesLink = document.getElementById("allclasses_navbar_bottom");
  if(window==top) {
    allClassesLink.style.display = "block";
  }
  else {
    allClassesLink.style.display = "none";
  }
  //-->
</script>
</div>
<div>
<ul class="subNavList">
<li>Summary:&nbsp;</li>
<li>Nested&nbsp;|&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.summary">Method</a></li>
</ul>
<ul class="subNavList">
<li>Detail:&nbsp;</li>
<li>Field&nbsp;|&nbsp;</li>
<li>Constr&nbsp;|&nbsp;</li>
<li><a href="#method.detail">Method</a></li>
</ul>
</div>
<a name="skip.navbar.bottom">
<!--   -->
</a></div>
<!-- ======== END OF BOTTOM NAVBAR ======= -->
</body>
</html>
